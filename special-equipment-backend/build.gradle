plugins {
    id 'idea'
    id 'java'
    id "org.springframework.boot" version "$LIB_SPRING_BOOT_VER"
}

apply plugin: 'io.spring.dependency-management'

group 'industry-services-com'
version '1.0-SNAPSHOT'


repositories {
}

compileJava {
    sourceCompatibility = 13
    targetCompatibility = 13
}

//对照更新依据https://mvnrepository.com/artifact/org.jetbrains.kotlin/kotlin-gradle-plugin
ext['kotlin.version'] = '1.3.71'


configurations {
    //编译排除掉 tomcat
    compile.exclude module: 'spring-boot-starter-tomcat'
}


dependencies {
    compileOnly('org.springframework.boot:spring-boot-configuration-processor')
    compileOnly('org.projectlombok:lombok')

    //graphql脱离web/MVC,  实际上spring-boot-starter-web对标spring-boot-starter-webflux关系二选一。
    //假如spring-boot-starter-web不添加照样跑，但是URL验证部分可能无法通过，想要测试graphiQL网页或者其它REST接口就需要它。
    //异步资源支持？ 'spring-boot-starter-web',改成 'spring-boot-starter-webflux' 替换副作用吗？
    implementation 'org.springframework.boot:spring-boot-starter-webflux'
    //添加依赖
    implementation 'org.springframework.boot:spring-boot-starter-undertow'


    compile "com.graphql-java-kickstart:graphql-spring-boot-starter:$LIB_GRAPHQL_SPRING_BOOT_VER"
    compile "com.graphql-java-kickstart:graphiql-spring-boot-starter:$LIB_GRAPHQL_SPRING_BOOT_VER"

    implementation "org.springframework.boot:spring-boot-starter-data-jpa"

    //加这个包注意，http://localhost:9000/；必须做登录接口部分对接处理，否则都是报错或者X-Frame-Options: DENY　status 401的。
    implementation "org.springframework.boot:spring-boot-starter-security"

    compile group: 'com.graphql-java-kickstart', name: 'altair-spring-boot-starter', version: "$LIB_GRAPHQL_SPRING_BOOT_VER"
    compile "org.springframework.boot:spring-boot-starter-websocket"

    implementation("org.springframework.boot:spring-boot-starter-jdbc")
    compile group: 'com.h2database', name: 'h2', version:'1.4.200'
    compile group: 'com.oracle', name: 'ojdbc6', version:'11.2.0.3'
    // implementation(project(":graphql-spring-boot-starter"))
    implementation "io.jsonwebtoken:jjwt:0.9.1"


    //compile "org.springframework.boot:spring-boot-starter-security"
    testCompile group: 'junit', name: 'junit', version: '4.12'
}


/* 
这样写竟然导致启动报错 websocket 找不到 web容器，tomcat却启动中，undertow注入异常。
   compile("org.springframework.boot:spring-boot-starter-web"){
         exclude module: 'spring-boot-starter-tomcat', group: 'org.springframework.boot'
    }
    compile("org.springframework.boot:spring-boot-starter-undertow")
*/

